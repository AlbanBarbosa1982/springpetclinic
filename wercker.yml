# docker box definition
box:
  id: openjdk
  ports:
    - "8080"

# Build definition
build:
  # The steps that will be executed on build
  steps:
    # A step that executes `spring-petclinic` command
    - script:
        name: run spring-petclinic
        code: |
          ./mvnw spring-boot:run &

# install goss
installgoss:
  steps:
    # A step that installs goss` 
    - script:
      name: Install goss test framework
      code: |
        curl -fsSL https://goss.rocks/install | sh
 
# change permissions on goss
permissions:
  steps:
    # A step changes permissions` 
    - script:
      name: chmod files
      code: |
        chmod +rx /usr/local/bin/goss

# autoadd goss
autoaddgoss:
  steps:
    # A step that autoadds goss tests port 8080` 
    - script:
      name: autoadd port 8080
      code: |
        /usr/local/bin/goss autoadd port 8080

# test goss
testgoss:
  steps:
    # A step that goss test if port 8080 is open 
    - script:
      name: test port 8080
      code: |
        /usr/local/bin/goss validate


