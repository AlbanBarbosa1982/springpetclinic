# docker box definition
box:
  id: openjdk
  ports:
    - "8080"

# Build definition
build:
  # The steps that will be executed on build
  steps:
    # A step that executes `spring-petclinic` command
    - script:
        name: run spring-petclinic
        code: |
          ./mvnw spring-boot:run &

# install goss
installgoss:
  steps:
    # A step that installs goss` 
    - script:
      name: test spring-petclinic
      code: |
        curl -L https://github.com/aelsabbahy/goss/releases/download/_VERSION_/goss-linux-amd64 -o /usr/local/bin/goss
chmod +rx /usr/local/bin/goss

# autoadd goss
autoaddgoss:
  steps:
    # A step that autoadds goss tests port 8080` 
    - script:
      name: autoadd port 8080
      code: |
        goss autoadd port 8080

# autoadd goss
testgoss:
  steps:
    # A step that goss test if port 8080 is open 
    - script:
      name: test port 8080
      code: |
        goss validate


